# task_executor.py ã®ä¿®æ­£éƒ¨åˆ†ï¼ˆexecute_taskãƒ¡ã‚½ãƒƒãƒ‰ã«è¿½åŠ ï¼‰
```python
# task_executor.py ã® execute_task ãƒ¡ã‚½ãƒƒãƒ‰å†…ã«è¿½åŠ 

async def execute_task(self, task: Dict) -> bool:
    """å˜ä¸€ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œï¼ˆWordPresså°‚ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå¯¾å¿œç‰ˆï¼‰"""
    task_id = task.get('task_id', 'UNKNOWN')
    
    try:
        # === ã‚¿ã‚¹ã‚¯é–‹å§‹ãƒ˜ãƒƒãƒ€ãƒ¼ ===
        print("\n" + "ğŸ“·"*40)
        print("=" * 80)
        print(f"ğŸ¯ ã‚¿ã‚¹ã‚¯é–‹å§‹: {task_id}")
        print("=" * 80)
        print(f"ğŸ“ å†…å®¹: {task['description'][:70]}...")
        print(f"ğŸ‘¤ æ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: {task['required_role'].upper()}")
        
        # ... ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—åˆ¤å®šã®æ—¢å­˜ã‚³ãƒ¼ãƒ‰ ...
        
        print("=" * 80)
        print("ğŸ“·"*40 + "\n")
        
        logger.info(f"ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œé–‹å§‹")
        
        # ã‚¿ã‚¹ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’'in_progress'ã«æ›´æ–°
        try:
            await self.update_task_status(task, 'in_progress')
        except Exception as e:
            logger.warning(f"âš ï¸ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°å¤±æ•—ï¼ˆç¶šè¡Œï¼‰: {e}")
        
        # æ‹…å½“AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å–å¾—
        role = task['required_role'].lower()
        
        # === ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š ===
        timeout_map = {
            'ma': 300.0,
            'content': 240.0,
            'review': 180.0,
            'wordpress': 300.0,
            'wp_design': 300.0,  # WordPressè¨­è¨ˆ
            'wp_dev': 300.0,     # WordPressé–‹ç™º
            'default': 180.0
        }
        
        # ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’å–å¾—
        task_type = 'default'
        if HAS_TASK_ROUTER and task_router:
            try:
                task_type = task_router.determine_task_type(task)
                logger.info(f"ğŸ“Š ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—åˆ¤å®š: {task_type}")
            except Exception as e:
                logger.warning(f"âš ï¸ ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—åˆ¤å®šå¤±æ•—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‡¦ç†: {e}")
        
        task_timeout = timeout_map.get(task_type, timeout_map.get(role, 180.0))
        
        # === ã‚¿ã‚¹ã‚¯å®Ÿè¡Œï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ãï¼‰ ===
        result = None
        
        try:
            # WordPresså°‚ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®åˆ¤å®šã‚’æœ€å„ªå…ˆ
            if role == 'wp_design':
                logger.info("="*60)
                logger.info("ğŸ¨ WordPressè¨­è¨ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œä¸­")
                logger.info("="*60)
                task_coro = self._execute_wp_design_task(task)
            
            elif role == 'wp_dev':
                logger.info("="*60)
                logger.info("ğŸ’» WordPressé–‹ç™ºAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œä¸­")
                logger.info("="*60)
                task_coro = self._execute_wp_dev_task(task)
            
            # ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ãƒ™ãƒ¼ã‚¹ã®åˆ†å²
            elif task_type == 'ma' and self.ma_executor:
                logger.info("="*60)
                logger.info("ğŸ“Š M&A/ä¼æ¥­æ¤œç´¢ã‚¿ã‚¹ã‚¯ã¨ã—ã¦å‡¦ç†")
                logger.info("="*60)
                task_coro = self.ma_executor.execute_ma_task(task)
            
            elif task_type == 'content' and self.content_executor:
                logger.info("="*60)
                logger.info("âœï¸ è¨˜äº‹ç”Ÿæˆã‚¿ã‚¹ã‚¯ã¨ã—ã¦å‡¦ç†")
                logger.info("="*60)
                task_coro = self.content_executor.execute_writer_task(task, role)
            
            elif task_type == 'review':
                logger.info("="*60)
                logger.info("âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¿ã‚¹ã‚¯ã¨ã—ã¦å‡¦ç†")
                logger.info("="*60)
                task_coro = self._execute_review_task(task)
            
            # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ­ãƒ¼ãƒ«åˆ†å²
            else:
                logger.info("="*60)
                logger.info(f"ğŸ“‹ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¹ã‚¯ ({role}) ã¨ã—ã¦å‡¦ç†")
                logger.info("="*60)
                
                if role == 'design':
                    task_coro = self._execute_design_task(task)
                elif role == 'dev':
                    task_coro = self._execute_dev_task(task)
                elif role == 'ui':
                    task_coro = self._execute_ui_task(task)
                elif role == 'wordpress':
                    task_coro = self._execute_wordpress_task(task)
                elif role == 'plugin':
                    task_coro = self._execute_plugin_task(task)
                else:
                    # æœªç™»éŒ²ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
                    agent = self.agents.get(role)
                    if not agent:
                        logger.warning(f"æ‹…å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ '{role}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ - ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™")
                        await self.update_task_status(task, 'skipped', error=f"ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœªç™»éŒ²")
                        return False
                    task_coro = agent.process_task(task)
            
            # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ãã§å®Ÿè¡Œ
            if HAS_ENHANCED_HANDLER:
                result = await EnhancedErrorHandler.timeout_wrapper(
                    task_coro,
                    timeout=task_timeout,
                    context=f"ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œ"
                )
            else:
                result = await asyncio.wait_for(task_coro, timeout=task_timeout)
        
        except asyncio.TimeoutError:
            logger.error("="*60)
            logger.error(f"â±ï¸ ã‚¿ã‚¹ã‚¯ {task_id} ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ{task_timeout}ç§’ï¼‰")
            logger.error("="*60)
            
            await self.update_task_status(
                task, 
                'failed', 
                error=f'ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ{task_timeout}ç§’ï¼‰'
            )
            
            print("\n" + "ğŸ“·"*40)
            print("=" * 80)
            print(f"â±ï¸ ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: {task_id}")
            print(f"åˆ¶é™æ™‚é–“: {task_timeout}ç§’")
            print("=" * 80)
            print("ğŸ“·"*40 + "\n")
            
            return False
        
        except Exception as e:
            logger.error("="*60)
            logger.error(f"âŒ ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œä¸­ã«ä¾‹å¤–ç™ºç”Ÿ")
            logger.error(f"ã‚¨ãƒ©ãƒ¼: {str(e)}")
            logger.error("="*60)
            
            if HAS_ENHANCED_HANDLER:
                EnhancedErrorHandler.log_error_with_context(
                    e, 
                    f"ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œ"
                )
            
            await self.update_task_status(task, 'failed', error=str(e))
            
            print("\n" + "ğŸ“·"*40)
            print("=" * 80)
            print(f"ğŸ’¥ ã‚¿ã‚¹ã‚¯ä¾‹å¤–: {task_id}")
            print(f"ä¾‹å¤–: {str(e)}")
            print("=" * 80)
            print("ğŸ“·"*40 + "\n")
            
            return False
        
        # === å®Ÿè¡Œçµæœã®å‡¦ç† ===
        if result and result.get('success'):
            logger.info("="*60)
            logger.info(f"âœ… ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡ŒæˆåŠŸ")
            logger.info("="*60)
            
            try:
                await self.update_task_status(task, 'completed')
                await self.save_task_output(task, result)
            except Exception as e:
                logger.warning(f"âš ï¸ çµæœä¿å­˜å¤±æ•—ï¼ˆã‚¿ã‚¹ã‚¯è‡ªä½“ã¯æˆåŠŸï¼‰: {e}")
            
            # ãƒ¬ãƒ“ãƒ¥ãƒ¼AIã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
            if self.review_agent and role != 'review' and task_type != 'review':
                try:
                    logger.info("="*60)
                    logger.info("âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼AIã§ãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹")
                    logger.info("="*60)
                    
                    if HAS_ENHANCED_HANDLER:
                        await EnhancedErrorHandler.timeout_wrapper(
                            self.perform_review_and_add_tasks(task, result),
                            timeout=120.0,
                            context=f"ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆã‚¿ã‚¹ã‚¯ {task_id}ï¼‰"
                        )
                    else:
                        await asyncio.wait_for(
                            self.perform_review_and_add_tasks(task, result),
                            timeout=120.0
                        )
                except Exception as e:
                    logger.warning(f"âš ï¸ ãƒ¬ãƒ“ãƒ¥ãƒ¼å¤±æ•—ï¼ˆç„¡è¦–ï¼‰: {e}")
            
            print("\n" + "ğŸ“·"*40)
            print("=" * 80)
            print(f"âœ… ã‚¿ã‚¹ã‚¯å®Œäº†: {task_id}")
            print(f"ã‚¿ã‚¤ãƒ—: {task_type.upper()}")
            print(f"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: æˆåŠŸ")
            print("=" * 80)
            print("ğŸ“·"*40 + "\n")
            
            return True
        else:
            error_msg = result.get('error', 'ä¸æ˜') if result else 'çµæœãªã—'
            logger.error("="*60)
            logger.error(f"âŒ ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œå¤±æ•—")
            logger.error(f"ã‚¨ãƒ©ãƒ¼: {error_msg}")
            logger.error("="*60)
            
            await self.update_task_status(task, 'failed', error=error_msg)
            
            print("\n" + "ğŸ“·"*40)
            print("=" * 80)
            print(f"âŒ ã‚¿ã‚¹ã‚¯å¤±æ•—: {task_id}")
            print(f"ã‚¿ã‚¤ãƒ—: {task_type.upper()}")
            print(f"ã‚¨ãƒ©ãƒ¼: {error_msg}")
            print("=" * 80)
            print("ğŸ“·"*40 + "\n")
            
            return False
    
    except Exception as e:
        logger.error(f"âŒ ã‚¿ã‚¹ã‚¯ {task_id} å‡¦ç†å…¨ä½“ã§äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼")
        
        if HAS_ENHANCED_HANDLER:
            EnhancedErrorHandler.log_error_with_context(
                e, 
                f"ã‚¿ã‚¹ã‚¯ {task_id} å…¨ä½“å‡¦ç†"
            )
        else:
            ErrorHandler.log_error(e, f"ã‚¿ã‚¹ã‚¯ {task_id} å®Ÿè¡Œ")
        
        try:
            await self.update_task_status(task, 'failed', error=str(e))
        except:
            pass
        
        print("\n" + "ğŸ“·"*40)
        print("=" * 80)
        print(f"ğŸ’¥ ã‚¿ã‚¹ã‚¯é‡å¤§ã‚¨ãƒ©ãƒ¼: {task_id}")
        print(f"ä¾‹å¤–: {str(e)}")
        print("=" * 80)
        print("ğŸ“·"*40 + "\n")
        
        return False

async def _execute_wp_design_task(self, task: Dict) -> Dict:
    """WordPressè¨­è¨ˆã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ"""
    logger.info("â”Œ" + "â”€"*58 + "â”")
    logger.info("â”‚ ğŸ¨ WordPressè¨­è¨ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œä¸­")
    logger.info("â”œ" + "â”€"*58 + "â”¤")
    logger.info(f"â”‚ ã‚¿ã‚¹ã‚¯: {task.get('description', 'N/A')[:50]}")
    logger.info("â””" + "â”€"*58 + "â”˜")
    
    try:
        agent = self.agents.get('wp_design')
        if not agent:
            logger.error("âŒ WordPressè¨­è¨ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“")
            return {
                'success': False,
                'error': 'wp_design ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“'
            }

        result = await agent.process_task(task)
        
        if result.get('success'):
            logger.info("âœ… WordPressè¨­è¨ˆAI: ã‚¿ã‚¹ã‚¯å®Œäº†")
        else:
            logger.error(f"âŒ WordPressè¨­è¨ˆAI: å¤±æ•— - {result.get('error', 'ä¸æ˜')}")
        
        return result
        
    except Exception as e:
        ErrorHandler.log_error(e, "WordPressè¨­è¨ˆã‚¿ã‚¹ã‚¯å®Ÿè¡Œ")
        logger.error(f"âŒ WordPressè¨­è¨ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: ä¾‹å¤–ç™ºç”Ÿ - {str(e)}")
        return {
            'success': False,
            'error': f'WordPressè¨­è¨ˆã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚¨ãƒ©ãƒ¼: {str(e)}'
        }

async def _execute_wp_dev_task(self, task: Dict) -> Dict:
    """WordPressé–‹ç™ºã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ"""
    logger.info("â”Œ" + "â”€"*58 + "â”")
    logger.info("â”‚ ğŸ’» WordPressé–‹ç™ºAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œä¸­")
    logger.info("â”œ" + "â”€"*58 + "â”¤")
    logger.info(f"â”‚ ã‚¿ã‚¹ã‚¯: {task.get('description', 'N/A')[:50]}")
    logger.info("â””" + "â”€"*58 + "â”˜")
    
    try:
        agent = self.agents.get('wp_dev')
        if not agent:
            logger.error("âŒ WordPressé–‹ç™ºAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“")
            return {
                'success': False,
                'error': 'wp_dev ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“'
            }
        
        result = await agent.process_task(task)
        
        if result.get('success'):
            logger.info("âœ… WordPressé–‹ç™ºAI: ã‚¿ã‚¹ã‚¯å®Œäº†")
        else:
            logger.error(f"âŒ WordPressé–‹ç™ºAI: å¤±æ•— - {result.get('error', 'ä¸æ˜')}")
        
        return result
        
    except Exception as e:
        ErrorHandler.log_error(e, "WordPressé–‹ç™ºã‚¿ã‚¹ã‚¯å®Ÿè¡Œ")
        logger.error(f"âŒ WordPressé–‹ç™ºAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: ä¾‹å¤–ç™ºç”Ÿ - {str(e)}")
        return {
            'success': False,
            'error': f'WordPressé–‹ç™ºã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚¨ãƒ©ãƒ¼: {str(e)}'
        }