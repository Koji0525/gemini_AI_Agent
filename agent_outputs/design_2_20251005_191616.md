# 設計書: M&A企業情報データベースのスキーマ設計とWordPressカスタムフィールド/カスタム投稿タイプ（CPT）の構成検討

タスクID: 2
作成日時: 2025-10-05T19:16:16.096359

---

経験豊富なシステム設計者として、M&A企業情報データベースのスキーマ設計とWordPressカスタムフィールド/カスタム投稿タイプ（CPT）の構成を詳細に設計します。

タスク概要

このタスクの目的は、先行タスク（要件定義）で洗い出されたM&A案件に必要なデータ項目を、WordPress上で最も効率的かつスケーラブルに管理するための具体的なデータベース構造（スキーマ）と、その実装手段であるカスタム投稿タイプ（CPT）およびカスタムフィールド（ACF）の構成を確定させることです。

目的

データ構造の定義: 案件情報を格納するためのテーブル（またはCPT）とフィールドの具体的な名称、型、制約を定義する。

WordPressへの落とし込み: WordPressの標準機能を最大限に活用し、CPTとカスタムフィールドをどのようにマッピングするかを明確にする。

検索効率の担保: 検索・絞り込みに必要な項目が、効率的なクエリ実行を可能にする構造になっていることを確認する。

設計内容

1. WordPress カスタム投稿タイプ (CPT) の構成

案件情報を管理するコアな入れ物として、カスタム投稿タイプ (CPT) を定義します。

項目	設定値	目的
CPT スラッグ	ma_deal	データベース内の識別子。
表示名	M&A案件	管理画面で表示される名称。
標準サポート項目	title, editor, custom-fields	WordPress標準のタイトルとコンテンツエディタ、カスタムフィールド機能を有効にする。
Google スプレッドシートにエクスポート

2. カスタムタクソノミー（絞り込み軸）の構成

絞り込み検索で利用する階層的・非階層的な分類項目は、WordPressのカスタムタクソノミーとして定義します。これにより、検索時のインデックスが効きやすくなります。

タクソノミー名	スラッグ	種類	目的
業種	industry	階層型 (Hierarchical)	大分類・中分類による絞り込みを可能にする (例: IT → SaaS)。
所在地	location	非階層型 (Non-Hierarchical)	地域や都市での絞り込みを可能にする (例: Tashkent, Samarkand)。
売却理由	sale_reason	非階層型 (Non-Hierarchical)	売却理由によるフィルタリングを可能にする。
Google スプレッドシートにエクスポート

3. M&A案件 カスタムフィールド スキーマ設計

カスタム投稿タイプ (ma_deal) に紐づく具体的なデータは、Advanced Custom Fields (ACF) を使用して以下のフィールドグループとして定義します。

ACF フィールド名 (Key)	データ型 (ACF Type)	必須/任意	スキーマ上の型/格納方法 (WP/DB)	概要
deal_status	Select	必須	meta_value (String)	募集中, 交渉中, 成約済。
target_price_usd	Number	必須	meta_value (Numeric)	取引希望額（USD）。数値検索に利用。
target_price_uzs	Number	任意	meta_value (Numeric)	取引希望額（ウズベキスタンスム）。
revenue_last_year	Number	必須	meta_value (Numeric)	直近1年間の売上実績。数値検索に利用。
ebitda	Number	必須	meta_value (Numeric)	企業の収益性指標。数値検索に利用。
business_summary	Text Area	必須	meta_value (Text)	事業概要（公開用）。
key_strengths	Text Area	任意	meta_value (Text)	強み、アピールポイント。
listing_expiry_date	Date Picker	必須	meta_value (Date/String)	掲載期限日。
confidentiality_level	Select	必須	meta_value (String)	閲覧制限レベル (公開/登録者限定/要審査)。
Google スプレッドシートにエクスポート

💡 スキーマ補足: WordPressのカスタムフィールドはwp_postmetaテーブルにKey-Value形式で格納されます。数値による絞り込み (例: target_price_usdのレンジ検索) の効率を高めるため、これらのフィールドには数値型としてDBに保存する設定（ACFの設定または開発時の工夫）が必要です。

4. API仕様の定義 (内部/外部連携)

WordPressのCPTとして案件を設計することで、標準のWordPress REST APIを利用したデータ取得が可能となります。

APIエンドポイント	HTTP Method	概要
/wp-json/wp/v2/ma_deal	GET	全てのM&A案件一覧を取得。
/wp-json/wp/v2/ma_deal/{id}	GET	特定のM&A案件詳細を取得。
Google スプレッドシートにエクスポート

パラメータ（検索・絞り込み）:

標準パラメータ: per_page, page, search (キーワード検索)

カスタムパラメータ: filter[meta_key], filter[meta_value], filter[tax_query] を利用し、カスタムフィールドの値やタクソノミーでフィルタリングする。

技術選定

技術要素	理由
カスタム投稿タイプ (CPT)	WordPressの標準機能であり、案件をブログ記事とは分離して独立したコンテンツタイプとして管理できる。管理画面の整備やREST APIとの連携が容易。
Advanced Custom Fields (ACF)	WordPressにおけるカスタムデータのデファクトスタンダード。豊富なフィールドタイプ（特にNumber, Select）を提供し、直感的なデータ入力インターフェースを提供できる。
カスタムタクソノミー	業種や所在地など、分類や階層化が必要な項目を効率的に管理し、データベースのインデックスを活かした高速な絞り込み検索を実現するのに最適。
Google スプレッドシートにエクスポート

実装における注意点

数値フィールドの型: target_price_usd, revenue_last_year, ebitdaなど、数値検索を行うフィールドは、wp_postmetaテーブルに格納される際、必ず数値として比較・クエリされるよう、メタデータの型を明示的に指定する必要があります（DECIMALまたはNUMERICとしてクエリ）。

機密性の担保: confidentiality_levelに基づき、閲覧制限を実装する際は、テンプレートレベルでのチェックだけでなく、WordPressのフックを用いてWP_Query実行時やREST API呼び出し時にもアクセス権限を確認する二重チェックが必要。

多言語対応の予約: 案件名やbusiness_summaryは将来的に多言語化が求められるため、PolylangやWPMLなどの多言語プラグインがカスタム投稿タイプとカスタムフィールドのデータを正しく複製・管理できるよう、設計段階から互換性を考慮する。

次のステップ

UI/UXワイヤーフレーム作成（タスクID: 3）: このスキーマで定義されたデータ項目と検索軸に基づき、ユーザーが実際に触れる検索インターフェースと案件詳細画面の具体的なデザイン（レイアウト、絞り込み項目の配置）を決定します。

CPT/ACF実装（タスクID: 4）: CPT UIとACFプラグインを用いて、この設計書通りにカスタム投稿タイプとカスタムフィールドをWordPress環境に実際に構築し、テストデータを入力できる状態にします。